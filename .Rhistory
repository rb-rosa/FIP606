family = poisson(link = "identity"))
# poisson: adequado para dados de contagem. Muito utilizado para nematoide.
plot(simulateResiduals(glm1))
# catPred é o mais importante
summary(glm1)
glm1_means <- emmeans(glm1, ~ spray)
cld(glm1_means)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(dplyr)
library(dplyr)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
View(aov1)
View(micelial)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)
View(insects)
# criando o objeto insects
insects <- tbl_df(InsectSprays)|>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)|>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)+
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)%>%
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
View(micelial)
insects <- read_excel("dados-diversos.xlsx")
head (micelial)
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
View(insects)
insects <- read_excel("dados-diversos.xlsx", "insects")
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(datasets)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(datasets)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
insects
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
b <- boxcox(lm(insects$count+0.1 ~ 1))
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
dplyr::select(spray, count)
insects
b <- boxcox(lm(insects$count+0.1 ~ 1))
lambda <- b$x[which.max(b$y)]
lambda
insects$count2 <- (insects$count ^ lambda - 1) / lambda # 34min
hist(insects$count) # muito assimétrico
hist(insects$count2) # mais simétrico
insects$count2
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
# criando o objeto insects
insects <- tibble::as_tibble(InsectSprays)|>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
micelial <- micelial |>
mutate(inc = inf_seeds/n_seeds*100,
rank_inc = rank(inc))
# rank transforma dados quando tem-se dois fatores. rank transforma a variável resposta para dois fatores
rank_anova <- aov(rank_inc ~ treat*dose, data = micelial)
summary(rank_anova)
library(emmeans)
means_rank <- emmeans(rank_anova, ~ treat | dose)
library(multcomp)
library(multcompView)
cld(means_rank)
# usar boxcox
library(MASS)
# criando o objeto insects
insects <- tibble::as_tibble(InsectSprays)|>
dplyr::select(spray, count)
insects
b <- boxcox(lm(insects$count+0.1 ~ 1))
lambda <- b$x[which.max(b$y)]
lambda
insects$count2 <- (insects$count ^ lambda - 1) / lambda # 34min
hist(insects$count) # muito assimétrico
hist(insects$count2) # mais simétrico
insects$count2
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
View(b)
lambda
insects$count2 <- (insects$count ^ lambda - 1) / lambda
insects$count2
insects$count2 <- (insects$count ^ lambda - 1) / lambda # 34min
insects$count2
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que há normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tibble::as_tibble(InsectSprays) |>
dplyr::select(spray, count)
insects
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
aov1 <- aov(count ~ spray, data = insects)
summary(aov1)
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias não são homogeneas, p < 0.05.
# nesse caso, recomenda-se transformar os dados para atender as premissas e então utilizar a ANOVA. Se as transformações não atenderem a homocedasticidade, utilizar teste não paramétrico.
# alternativa 1: transformar dados originais, se for números. Usar raiz quadrada ou logaritimo
# sqrt:  raiz quadrada
# log: logarítimo. se houver valor zero no "count" somar 0.5.
aov2 <- aov(sqrt(count) ~ spray, data = insects)
#aov2 <- aov(log(count+0.5) ~ spray, data = insects)
summary(aov2)
check_heteroscedasticity(aov2)
check_normality(aov2)
# atenteu as premissas
library(emmeans)
# médias por inseticida
# type = "response": para que a média não seja transformada, o inverso da raiz
aov2_means <- emmeans(aov2, ~ spray, type = "response")
aov2_means
# comparação entre pares
pwpm(aov2_means)
# com letras
library(multcomp)
library(multcompView)
cld(aov2_means)
# teste não paramétrico, se não atendeu as premissas da ANOVA mesmo com transformção dos dados.
kruskal.test(count ~ spray, data = insects)
library(agricolae)
kruskal(insects$count, insects$spray, console = TRUE)
glm1 <- glm(count ~ spray,
data = insects,
family = poisson(link = "identity"))
# poisson: adequado para dados de contagem. Muito utilizado para nematoide.
plot(simulateResiduals(glm1))
# catPred é o mais importante
summary(glm1)
glm1_means <- emmeans(glm1, ~ spray)
cld(glm1_means)
lambda
