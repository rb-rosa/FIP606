# Chunk 1
library(tidyverse)
mg <- read_csv("dados-diversos.csv")
library(tidyverse)
library(readxl)
library(ggplot2)
library(remotes)
remotes::install_github("emdelponte/r4pde")
library(readxl)
library(tidyverse)
dat <- read_excel("dados-diversos.xlsx", "fungicida_vaso")
dat2 <- dat |>
# mutate para criar uma variável
mutate(inc = dis_sp / n_sp*100)
dat2 |>
ggplot(aes(x = treat,
y = inc))+
geom_jitter(width = 0.1)+
facet_wrap(~ dose)
m1 <- aov(log(inc +0.5) ~ treat*dose,
data = dat2)
summary(m1)
library(performance)
check_normality(m1)
# p=0.050 considera-se dados normais.
check_heteroscedasticity(m1)
library(DHARMa)
plot(simulateResiduals(m1))
library(emmeans)
means_m1 <- emmeans(m1, ~ dose | treat,
type = "response")
means_m1
library(multcompView)
library(multcomp)
# para comparar as médias.
cld(means_m1)
# para calcular o coeficiente de variação
library(agricolae)
cv.model(m1)
milho <- read_excel("dados-diversos.xlsx",
"armazena")
milho2 <- milho |>
filter(tempo == 8)
milho2 |>
ggplot(aes(factor(tipo), peso_mil,
color = factor(umidade)))+
geom_jitter(width = 0.1)+
facet_wrap(~umidade)
m2 <- aov(peso_mil ~ factor(tipo)*factor(umidade),
data = milho2)
summary(m2)
#quando não houver significãncia entre a interação, testar as variáveis independentes.
milho3 <- read_excel("dados-diversos.xlsx",
"milho")
m4 <- aov(yield ~ hybrid,
data = milho3)
summary(m4)
check_heteroscedasticity(m4)
plot(simulateResiduals(m4))
medias_m4 <- emmeans(m4, ~ hybrid)
medias_m4
#Tuckey
cld(medias_m4)
pwpm(medias_m4)
pwpp(medias_m4)
View(m4)
library(tidyverse)
library(readxl)
mg <- read_excel("dados-diversos.xlsx")
### entra no mg, então
p_box <- mg |> ggplot(aes(trat, comp))+
#geom_point()+
# outlier.color = NA - retirar ponto outline do
geom_boxplot(outlier.color = NA,
fill = "orange",
size  = 0.5,
width = 0.2)+
# para desagregar os pontos
geom_jitter(width=0.1,
height = 0,
size = 2,
color = "steelblue")+
# a escala do y, que é continua, defina os limetes de 5 a 20
scale_y_continuous(limits = c(7,19),
n.breaks = 10)+
#alterar legenda do eixo Y
labs(y = "Lesion size (mm)")+
labs(x = "")+
theme_bw()
#para chamar o objeto criado como p_means
p_box
#para sarvar em uma pasta dentro do projeto com background (bg) branco
ggsave("figs/plot2.png",
width = 4,
height = 4,
bg = "white")
#preparar o conjunto para fazer gráfico de barras
library(ggthemes)
p_means <- mg |>
#agrupo por tratamento e sumariza o valor médio do comprimento
group_by(trat) |>
#cria a variável comp_mean
summarise(comp_mean = mean(comp),
comp_sd = sd(comp)) |>
ggplot(aes(trat, comp_mean))+
#geom_col(fill = "orange", width = 0.5)+
geom_point()+
scale_y_continuous(limits = c(7,18),
n.breaks = 6)+
#adicionar barra de erro (desvio padrão dos dados originais), estística descritiva
geom_errorbar(aes(ymin = comp_mean - comp_sd,
ymax = comp_mean + comp_sd,
width = 0.05))+
theme_bw() +
labs(y = "Lesion size (mm)")+
labs(x = "")
#para chamar o objeto criado como p_means
p_means
ggsave("figs/mean_sd.png",
width = 4,
height = 4,
bg = "white")
library(patchwork)
#(p_box | p_means) / p_box
(p_box | p_means) +
plot_annotation(tag_levels = 'A',
title = 'Gráficos que impressionam')
ggsave("figs/combined.png")
survey <- read_excel("dados-diversos.xlsx", sheet = "survey")
survey |>
#filtra onde estado é igual a RS
filter(state == "RS") |>
count(species,residue) |>
ggplot(aes(species,n))+
geom_col(width = 0.4,
fill = "steelblue")+
#para girar o gráfico
coord_flip()+
#ncol para configurar em uma coluna
facet_wrap(~residue, ncol = 1)
labs (x = "",
y = "Number of isolates",
title = "Horizontal bar plot",
subtitle = "Using ggplot")+
theme_bw()
ggsave("figs/barplot.png", bg = "white")
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
aov1 <- aov(count ~ spray, data = insects)
summary(aov1)
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias não são homogeneas, p < 0.05.
# nesse caso, recomenda-se transformar os dados para atender as premissas e então utilizar a ANOVA. Se as transformações não atenderem a homocedasticidade, utilizar teste não paramétrico.
# alternativa 1: transformar dados originais, se for números. Usar raiz quadrada ou logaritimo
# sqrt:  raiz quadrada
# log: logarítimo. se houver valor zero no "count" somar 0.5.
aov2 <- aov(sqrt(count) ~ spray, data = insects)
#aov2 <- aov(log(count+0.5) ~ spray, data = insects)
summary(aov2)
check_heteroscedasticity(aov2)
check_normality(aov2)
# atenteu as premissas
library(emmeans)
# médias por inseticida
# type = "response": para que a média não seja transformada, o inverso da raiz
aov2_means <- emmeans(aov2, ~ spray, type = "response")
aov2_means
# comparação entre pares
pwpm(aov2_means)
# com letras
library(multcomp)
library(multcompView)
cld(aov2_means)
# teste não paramétrico, se não atendeu as premissas da ANOVA mesmo com transformção dos dados.
kruskal.test(count ~ spray, data = insects)
library(agricolae)
kruskal(insects$count, insects$spray, console = TRUE)
glm1 <- glm(count ~ spray,
data = insects,
family = poisson(link = "identity"))
# poisson: adequado para dados de contagem. Muito utilizado para nematoide.
plot(simulateResiduals(glm1))
# catPred é o mais importante
summary(glm1)
glm1_means <- emmeans(glm1, ~ spray)
cld(glm1_means)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(dplyr)
library(dplyr)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
View(aov1)
View(micelial)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)
View(insects)
# criando o objeto insects
insects <- tbl_df(InsectSprays)|>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)|>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)+
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays)%>%
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
View(micelial)
insects <- read_excel("dados-diversos.xlsx")
head (micelial)
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
View(insects)
insects <- read_excel("dados-diversos.xlsx", "insects")
insects <- tbl_df(InsectSprays) |>
select_(spray, count)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
# criando o objeto insects
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(readxl)
library(tidyverse)
micelial <- read_excel("dados-diversos.xlsx", "micelial")
head (micelial)
micelial|>
ggplot(aes(especie, tcm)) +
geom_boxplot()
#Ajustar o modelo
# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)
aov1 <- aov(tcm ~ especie, data = micelial)
summary(aov1)
#Não há efeito significativo de espécie P=0.117.
#Checar as premissas para verificar se o modelo está correto
library(performance)
check_heteroscedasticity(aov1)
#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.
check_normality(aov1)
#OK: residuals appear as normally distributed (p = 0.074). Significa que a normalidade
library(DHARMa)
plot(simulateResiduals(aov1))
#Normalidade a direita e variância homogenea a esquerda
# teste de normalidade
hist(aov1$residuals)
qqnorm(aov1$residuals)
qqline(aov1$residuals)
shapiro.test(aov1$residuals)
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(datasets)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
library(datasets)
insects <- tbl_df(InsectSprays) |>
select(spray, count)
insects|>
ggplot(aes(spray, count)) +
geom_boxplot()
