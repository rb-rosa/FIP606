{
  "hash": "f8ff9731aabb86a23bf6fb1905a9a304",
  "result": {
    "markdown": "---\ntitle: \"aula14\"\nformat: html\n\nexecute: \n  freeze: auto\n  cache: true\n  warning: false\n---\n\n\n## Modelo linear de segunda ordem\n\n# Com mais um parâmetro, quadrática\n\n# Nesse exemplo tem-se uma variável independente, que é um nível de um fator do experimento. Como é quantitativo, fazer regressão linear. Então, deve-se observar se é linear simples ou quadrática (nesse caso). Logo, usar o \"lm\", verificar o ajuste, verificar os coeficientes, pegar a equação que vai predizer o valor de y para cada valor de x ou x², dependendo do modelo usado, que vai reportar os coeficientes de variação, o R².\n\n## Ajustar modelo de segunda ordem\n\n# variável independente\n\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-1_e90a0dc501a3dddc3af0b661d8d46909'}\n\n```{.r .cell-code}\n# \n\nlibrary(readxl)\nlibrary(tidyverse)\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n\nestande |> \n  ggplot(aes(trat, nplants, group = exp))+\n  geom_point()+\n  facet_wrap(~exp)+\n  ylim(0, max(estande$nplants))+\n  geom_smooth(se = F)\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n## Ajustar modelo linear e quadrático no ggplot\n\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-2_f48eccfefc5dc60116889ac495e2f95e'}\n\n```{.r .cell-code}\nestande2 <- estande |> \n  filter(exp ==2) |> \n  group_by(trat) |>\n  summarise(mean_nplants = mean(nplants))\n\nestande2 |> \n  ggplot(aes(trat, mean_nplants))+\n  geom_point()+\n  #geom_line()+\n  geom_smooth(se = F, formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  theme_minimal()+\n  annotate(geom = \"text\",\n           x = 25, y = 70,\n           label = \"y = 66.3 - 1.777x + 0.0222x²\n           R² = 0.88\")\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# R² = coeficiente de determinação, 49 minutos\n```\n:::\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-3_d1db729e70dc792e330bfdcf299e7406'}\n\n```{.r .cell-code}\nestande2 <- estande2 |> \n  mutate(trat2 = trat^2)\n\nm1 <- lm(mean_nplants ~ trat, data = estande2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mean_nplants ~ trat, data = estande2)\n\nResiduals:\n     1      2      3      4      5      6 \n12.764 -2.134 -6.782 -3.327 -4.669  4.147 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     4.5505  13.402 0.000179 ***\ntrat         -0.7007     0.2012  -3.483 0.025294 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.117 on 4 degrees of freedom\nMultiple R-squared:  0.752,\tAdjusted R-squared:   0.69 \nF-statistic: 12.13 on 1 and 4 DF,  p-value: 0.02529\n```\n:::\n\n```{.r .cell-code}\n# Adjusted R-squared:   0.69 = 69% de plantas é explicado pelo tratamento de acordo com o modelo linear.\n# histograma dos resíduos\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nm2 <- lm(mean_nplants ~ trat + trat2, data = estande2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mean_nplants ~ trat + trat2, data = estande2)\n\nResiduals:\n      1       2       3       4       5       6 \n 7.4484 -4.4200 -6.4386  1.0739  3.0474 -0.7111 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.70800  14.083 0.000776 ***\ntrat        -1.77720    0.62263  -2.854 0.064878 .  \ntrat2        0.02223    0.01242   1.790 0.171344    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.517 on 3 degrees of freedom\nMultiple R-squared:  0.8801,\tAdjusted R-squared:  0.8001 \nF-statistic: 11.01 on 2 and 3 DF,  p-value: 0.04152\n```\n:::\n\n```{.r .cell-code}\nAIC(m1, m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   df      AIC\nm1  3 45.72200\nm2  4 43.36151\n```\n:::\n:::\n\n\n# Relacionar duas respostas\n\nDuas variáveis resposta do tipo númerica quantitativa. . Para saber se há associação entre duas variáveis dependentes.\n\nPrimeiro, fazer análise para testar a associação. A análise de correlação dá o coeficiente de correlação de Pearson (R), que é a raiz do R², que será sempre maior que o R².\n\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-4_56baa9301726ee66057a9878e397867b'}\n\n```{.r .cell-code}\nmofo <- read_excel(\"dados-diversos.xlsx\", \"mofo\")\n\nmofo |> \n  ggplot(aes(inc, yld))+\n  geom_point()+\n  facet_wrap(~study)+\n  geom_smooth(se = F, method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-5_b19ff403ebb69643b2fa8959696f2d6b'}\n\n```{.r .cell-code}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n:::\n\n```{.r .cell-code}\n# Correlação linear resume (mensura) o grau de associação entre duas variáveis (x e y). Fornece um número que resume o grau de associação entre a duas variáveis. A análise de regressão indica o efeito de uma mudança da unidade na variável explicativa (x) em relação a variável resposta (y). Ela descreve o efeito, por meio de uma equação, da variável explicativa em relação a variável resposta.\n# teste de correlação, de pearson, quando tem normalidade. Testar a associação. Quanto maior o cor, maior a associação. Quanto mais disperso os pontos, menor a associação.\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -10.9, df = 11, p-value = 3.105e-07\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9872663 -0.8579544\nsample estimates:\n      cor \n-0.956692 \n```\n:::\n\n```{.r .cell-code}\n#função cor\npcor <- cor(mofo1 |> select(3:5))\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-6_9b7626009c09471bd416953c5a3a368f'}\n\n```{.r .cell-code}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n:::\n\n```{.r .cell-code}\n#teste de normalidade\nshapiro.test(mofo$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mofo$inc\nW = 0.94315, p-value = 0.01507\n```\n:::\n\n```{.r .cell-code}\n# usar spearman (não paramétrica, quando não assume normalidade) quando falta de normalidade. Usar sperarman como padrão \ncor.test(mofo1$inc, mofo1$yld, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tSpearman's rank correlation rho\n\ndata:  mofo1$inc and mofo1$yld\nS = 715.97, p-value = 7.166e-08\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.9669458 \n```\n:::\n\n```{.r .cell-code}\n#função cor\npcor <- cor(mofo1 |> select(3:5), method = \"spearman\")\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='aula14_cache/html/unnamed-chunk-7_3152ab37c1b838d031127adee113949f'}\n\n```{.r .cell-code}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n:::\n\n```{.r .cell-code}\n#teste de normalidade\nshapiro.test(mofo$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mofo$inc\nW = 0.94315, p-value = 0.01507\n```\n:::\n\n```{.r .cell-code}\n# usar kendall (não paramétrica, quando não assume normalidade) para dados (variável) ordinais\ncor.test(mofo1$inc, mofo1$yld, method = \"kendall\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKendall's rank correlation tau\n\ndata:  mofo1$inc and mofo1$yld\nz = -4.1641, p-value = 3.125e-05\nalternative hypothesis: true tau is not equal to 0\nsample estimates:\n       tau \n-0.8831914 \n```\n:::\n\n```{.r .cell-code}\n#função cor\npcor <- cor(mofo1 |> select(3:5), method = \"kendall\")\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](aula14_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}