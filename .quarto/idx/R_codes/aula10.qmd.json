{"title":"**1 Fator**","markdown":{"yaml":{"title":"**1 Fator**","format":"html","execute":{"freeze":"auto","cache":true,"warning":false}},"headingText":"Três ou mais tratamentos","containsRefs":false,"markdown":"\n\nAula 10\n\n\nANOVA é feita para níveis categóricos (fator qualitativo). Na ANOVA, queremos saber quem é diferente de quem.\n\nExperimento com um fator e em delineamento inteiramente casualizado para comparar o crescimento micelial de diferentes espécies de um fungo fitopatogênico. A resposta a ser estudada é a TCM = taxa de crescimento micelial.\n\n## Preparo\n\n```{r}\nlibrary(readxl)\nlibrary(tidyverse)\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead (micelial)\n\n```\n\n```{r}\nmicelial|> \n  ggplot(aes(especie, tcm)) +\n  geom_boxplot()\n```\n\n## Ajustar o modelo usando `aov()`\n\n```{r}\n#Ajustar o modelo\n# <- (atribuiu aov a aov1); ~ (em função de); aov (função ANOVA)\naov1 <- aov(tcm ~ especie, data = micelial)\nsummary(aov1)\n#Não há efeito significativo de espécie P=0.117.\n\n```\n\n## Testar as premissas\n\nOs prossupostos da ANOVA são normalidade e a homocedasticidade dos dados. Se são normais e apresentam igualdade de variâncias, então pode se realizar ANOVA. Se os dados não forem normais e não apresentarem igualdade, pode-se fazer a transformação dos dados, se não funcionar, utilizar modelos não paramétricos, se não, usar modelo linear generalizao (GLM) ou outros. Falta de homocedasticidade não é tolerável, de normalidade, sim.\n\n```{r}\n#Checar as premissas para verificar se o modelo está correto\nlibrary(performance)\ncheck_heteroscedasticity(aov1)\n#Resultado: OK. Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias são homogeneas.Se o p-valor for < 0.05 indica que os dados não são homogeneos.\ncheck_normality(aov1)\n#OK: residuals appear as normally distributed (p = 0.074). Significa que há normalidade. Se o p-valor for < 0.05 indica que os dados não apresentam normalidade.\nlibrary(DHARMa)\nplot(simulateResiduals(aov1))\n#Normalidade a direita e variância homogenea a esquerda\n# teste de normalidade\nhist(aov1$residuals)\nqqnorm(aov1$residuals)\nqqline(aov1$residuals)\nshapiro.test(aov1$residuals)\n```\n\n## E quando não atende às premissas?\n\nEfeito de inseticida na mortalidade de insetos (Beall, 1942). The Transformation of data from entomological field experiments, Biometrika, 29, 243--262. Dados no pacote \"datasets\" do R. data(InsectSprays)\n\n```{r}\n# criando o objeto insects\ninsects <- tibble::as_tibble(InsectSprays) |> \n  dplyr::select(spray, count)\ninsects\n```\n\n```{r}\ninsects|> \n  ggplot(aes(spray, count)) +\n  geom_boxplot()\n```\n\n```{r}\naov1 <- aov(count ~ spray, data = insects)\nsummary(aov1)\n\nlibrary(performance)\ncheck_heteroscedasticity(aov1)\n#OK: Error variance appears to be homoscedastic (p = 0.175). Significa que as variâncias não são homogeneas, p < 0.05.\n\n\n# nesse caso, recomenda-se transformar os dados para atender as premissas e então utilizar a ANOVA. Se as transformações não atenderem a homocedasticidade, utilizar teste não paramétrico.\n# alternativa 1: transformar dados originais, se for números. Usar raiz quadrada ou logaritimo\n# sqrt:  raiz quadrada\n# log: logarítimo. se houver valor zero no \"count\" somar 0.5.\naov2 <- aov(sqrt(count) ~ spray, data = insects)\n#aov2 <- aov(log(count+0.5) ~ spray, data = insects)\nsummary(aov2)\ncheck_heteroscedasticity(aov2)\ncheck_normality(aov2)\n# atenteu as premissas\n\nlibrary(emmeans)\n# médias por inseticida\n# type = \"response\": para que a média não seja transformada, o inverso da raiz\naov2_means <- emmeans(aov2, ~ spray, type = \"response\")\naov2_means\n# comparação entre pares\npwpm(aov2_means)\n# com letras\nlibrary(multcomp)\nlibrary(multcompView)\ncld(aov2_means)\n\n# teste não paramétrico, se não atendeu as premissas da ANOVA mesmo com transformção dos dados.\nkruskal.test(count ~ spray, data = insects)\nlibrary(agricolae)\nkruskal(insects$count, insects$spray, console = TRUE)\n\n```\n\n## Modelo linear generalizado\n\nPara publicar artigo, o modelo linear é melhor que transformar os dados originais. É mais elegante usar o glm do que transformar os dados.\n\n```{r}\nglm1 <- glm(count ~ spray,\n         data = insects,\n         family = poisson(link = \"identity\"))\n# poisson: adequado para dados de contagem. Muito utilizado para nematoide.\nplot(simulateResiduals(glm1))\n# catPred é o mais importante\nsummary(glm1)\nglm1_means <- emmeans(glm1, ~ spray)\ncld(glm1_means)\n\n\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"aula10.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.475","editor":"visual","theme":"default","title":"**1 Fator**"},"extensions":{"book":{"multiFile":true}}}}}