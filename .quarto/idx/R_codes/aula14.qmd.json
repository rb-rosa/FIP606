{"title":"**Linear de segunda ordem**","markdown":{"yaml":{"title":"**Linear de segunda ordem**","format":"html","execute":{"freeze":"auto","cache":true,"warning":false}},"headingText":"Ajustar modelo de segunda ordem","containsRefs":false,"markdown":"\n\nAula 14\n\nCom mais um parâmetro, quadrática\n\nNesse exemplo tem-se uma variável independente, que é um nível de um fator do experimento. Como é quantitativo, fazer regressão linear. Então, deve-se observar se é linear simples ou quadrática (nesse caso). Logo, usar o \"lm\", verificar o ajuste, verificar os coeficientes, pegar a equação que vai predizer o valor de y para cada valor de x ou x², dependendo do modelo usado, que vai reportar os coeficientes de variação, o R².\n\n\nVariável independente\n\n```{r}\n# \n\nlibrary(readxl)\nlibrary(tidyverse)\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n\nestande |> \n  ggplot(aes(trat, nplants, group = exp))+\n  geom_point()+\n  facet_wrap(~exp)+\n  ylim(0, max(estande$nplants))+\n  geom_smooth(se = F)\n```\n\n## Ajustar modelo linear e quadrático no ggplot\n\n```{r}\nestande2 <- estande |> \n  filter(exp ==2) |> \n  group_by(trat) |>\n  summarise(mean_nplants = mean(nplants))\n\nestande2 |> \n  ggplot(aes(trat, mean_nplants))+\n  geom_point()+\n  #geom_line()+\n  geom_smooth(se = F, formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  theme_minimal()+\n  annotate(geom = \"text\",\n           x = 25, y = 70,\n           label = \"y = 66.3 - 1.777x + 0.0222x²\n           R² = 0.88\")\n# R² = coeficiente de determinação, 49 minutos\n  \n```\n\n```{r}\nestande2 <- estande2 |> \n  mutate(trat2 = trat^2)\n\nm1 <- lm(mean_nplants ~ trat, data = estande2)\nsummary(m1)\n# Adjusted R-squared:   0.69 = 69% de plantas é explicado pelo tratamento de acordo com o modelo linear.\n# histograma dos resíduos\nhist(m1$residuals)\n\nm2 <- lm(mean_nplants ~ trat + trat2, data = estande2)\nsummary(m2)\n\nAIC(m1, m2)\n```\n\n## Relacionar duas respostas\n\nDuas variáveis resposta do tipo númerica quantitativa. Para saber se há associação entre duas variáveis dependentes.\n\nPrimeiro, fazer análise para testar a associação. A análise de correlação dá o coeficiente de correlação de Pearson (R), que é a raiz do R², que será sempre maior que o R².\n\n```{r}\nmofo <- read_excel(\"dados-diversos.xlsx\", \"mofo\")\n\nmofo |> \n  ggplot(aes(inc, yld))+\n  geom_point()+\n  facet_wrap(~study)+\n  geom_smooth(se = F, method = \"lm\")\n```\n\n## Correlação linear\n\n```{r}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n# Correlação linear resume (mensura) o grau de associação entre duas variáveis (x e y). Fornece um número que resume o grau de associação entre a duas variáveis. A análise de regressão indica o efeito de uma mudança da unidade na variável explicativa (x) em relação a variável resposta (y). Ela descreve o efeito, por meio de uma equação, da variável explicativa em relação a variável resposta.\n# teste de correlação, de pearson, quando tem normalidade. Testar a associação. Quanto maior o cor, maior a associação. Quanto mais disperso os pontos, menor a associação.\ncor.test(mofo1$inc, mofo1$yld)\n#função cor\npcor <- cor(mofo1 |> select(3:5))\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n\n## Spearman (não paramétrica)\n\n```{r}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n#teste de normalidade\nshapiro.test(mofo$inc)\n# usar spearman (não paramétrica, quando não assume normalidade) quando falta de normalidade. Usar sperarman como padrão \ncor.test(mofo1$inc, mofo1$yld, method = \"spearman\")\n#função cor\npcor <- cor(mofo1 |> select(3:5), method = \"spearman\")\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n\n## kendall (não paramétrica)\n\n```{r}\nmofo1 <- mofo |> \n  filter(study == 3)\nmofo1\n#teste de normalidade\nshapiro.test(mofo$inc)\n# usar kendall (não paramétrica, quando não assume normalidade) para dados (variável) ordinais\ncor.test(mofo1$inc, mofo1$yld, method = \"kendall\")\n#função cor\npcor <- cor(mofo1 |> select(3:5), method = \"kendall\")\nlibrary(corrplot)\ncorrplot (pcor, method = \"number\", type = \"lower\")\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"aula14.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.475","editor":"visual","theme":"spacelab","title":"**Linear de segunda ordem**"},"extensions":{"book":{"multiFile":true}}}}}