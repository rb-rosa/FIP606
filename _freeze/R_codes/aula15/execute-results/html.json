{
  "hash": "c0d3279794aeb77e0d511b000d20e669",
  "result": {
    "markdown": "---\ntitle: \"**Chi-squared/Fisher's Test**\"\nformat: html\neditor: visual\n\nexecute: \n  freeze: auto\n  cache: true\n  warning: false\n---\n\n\nAula 15\n\nTeste para dados de levantamento e variável categorica nominal ano, resto cultural...\n\n\n::: {.cell hash='aula15_cache/html/unnamed-chunk-1_56d7efa8f387bfaacb05e9ab15df8a71'}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(tidyverse)\nsurvey <- read_excel(\"dados-diversos.xlsx\", \"survey\")\n\nsurvey |> \n  count(year) # frequências de ocorrências por ano\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n   year     n\n  <dbl> <int>\n1  2009   265\n2  2010   216\n3  2011   185\n```\n:::\n\n```{.r .cell-code}\n# table é do R base e não do tidyverse\nq <- table (survey$year, survey$species) # em formato largo\n\nlibrary(janitor)\nsurvey |> \n  tabyl(year, species) |> # dá o mesmo resultado do table, em formato largo\n  adorn_percentages() # dá o vlaor em porcentagem\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n year      Fgra      Fspp\n 2009 0.8490566 0.1509434\n 2010 0.8657407 0.1342593\n 2011 0.7567568 0.2432432\n```\n:::\n\n```{.r .cell-code}\n# gráfico de barras é indicado para visualizar frequências. O gráfico precisa ser no formato longo\nsurvey |> \n  count(year, species) |> # dá o formato longo \n  ggplot(aes(year, n, fill = species))+\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsurvey |> \n  filter(residue != \"NA\") |> \n  count(residue, species) |> # dá o formato longo \n  ggplot(aes(residue, n, fill = species))+\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Chi-squared test\n# a hipótese nula é que a frequência são iguais\n\nq <- table (survey$residue, survey$species)\nchisq.test(q)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  q\nX-squared = 1.1997, df = 1, p-value = 0.2734\n```\n:::\n\n```{.r .cell-code}\n#Fisher's Exact Test\nfisher.test(q) # usado quando a frequência é baixa, número muito baixo, menor que 6\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  q\np-value = 0.2118\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.357205 1.311411\nsample estimates:\nodds ratio \n 0.6819103 \n```\n:::\n\n```{.r .cell-code}\nq <- table (survey$residue, survey$inc_class)\nchisq.test(q) # p-value = 0.1058: classe da frequência da doença independe do resto cultural\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  q\nX-squared = 2.6165, df = 1, p-value = 0.1058\n```\n:::\n\n```{.r .cell-code}\nsurvey |> \n  filter(residue != \"NA\") |> \n  count(residue, inc_class) |> # dá o formato longo \n  ggplot(aes(residue, n, fill = inc_class))+\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n\n\n## Curva de progresso da severidade\n\nPlanilha dados-diversos, aba curve: dado temporal\n\n\n::: {.cell hash='aula15_cache/html/unnamed-chunk-2_d9aa844751fde92e23cd2f4b0f4ad4d0'}\n\n```{.r .cell-code}\ncurve <- read_excel(\"dados-diversos.xlsx\", \"curve\")\n\ncurve |> \n  group_by(Irrigation, day) |> # manter irrigation e day e desconsiderar rep\n  summarise(mean_severity = mean(severity), \n            sd_severity = sd(severity))|> \n  ggplot(aes(day, mean_severity, color = Irrigation))+\n  geom_point()+\n  geom_errorbar(aes(ymin = mean_severity - sd_severity, ymax = mean_severity + sd_severity), width = 0.1)+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Calcular área abaixo da curva do progresseo da doença\n\nlibrary(epifitter)\n\ncurve3 <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(audpc = AUDPC(day, severity, \n                          y_proportion = F)) |> \n  # Aplicar T-test para dois grupos\n  # Primeiro passar para o formato largo\n  pivot_wider(1, names_from = Irrigation, values_from = audpc)\n\nt.test(curve3$Drip, curve3$Furrow)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  curve3$Drip and curve3$Furrow\nt = -1.3773, df = 3.079, p-value = 0.26\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -1.3421436  0.5231436\nsample estimates:\nmean of x mean of y \n 13.38983  13.79933 \n```\n:::\n:::\n\n\n## Experimetno fatorial\n\n\n::: {.cell hash='aula15_cache/html/unnamed-chunk-3_96954e6539a43f74ac613db57d885a32'}\n\n```{.r .cell-code}\nlibrary(gsheet)\ntw <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1t5xftb0xSRPNFhM7h_MiPNtwt2UFUcm9/edit?rtpof=true\")\n\ntw |> \n  group_by(cult, silicio, hai) |> \n   summarise(mean_lesion = mean(lesion_size), sd_lesion = sd(lesion_size)) |> \n  ggplot(aes(hai, mean_lesion, color = silicio))+\n  geom_point()+\n  geom_errorbar(aes(ymin = mean_lesion - sd_lesion, \n                    ymax = mean_lesion + sd_lesion), \n                width = 0.1)+\n  geom_line()+\n  facet_wrap(~cult)+\n  labs(x = \"Hours after inoculation\", y = \"Lesion size (mm)\")\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Calcular área abaixo da curva do tamanho da lesão\n\nlibrary(epifitter)\n\ntw2 <- tw |> \n  group_by(exp, cult, silicio, rep) |> \n  summarise(audpc = AUDPC(lesion_size, hai))\n\ntw2|> \n  ggplot(aes(cult, audpc, color = silicio))+\n  geom_boxplot()+\n  facet_wrap(~exp)\n```\n\n::: {.cell-output-display}\n![](aula15_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n## ANOVA aov() para área abaixo da curva\n\n\n::: {.cell hash='aula15_cache/html/unnamed-chunk-4_c0c8a73c4898f8731a3e5cb229ba5048'}\n\n```{.r .cell-code}\n# qualitativo, ANOVA para a área abaixo da curva\n# Experimetno fatorial. Primeiro, testar o experimento completo, se não for significativo, reduzir o modelo. \naov1 <- aov(audpc ~exp*cult*silicio, data = tw2)\nsummary(aov1) # não deu significativo\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 Df  Sum Sq Mean Sq F value   Pr(>F)    \nexp               1   54544   54544   0.533 0.470257    \ncult              1  751290  751290   7.335 0.010281 *  \nsilicio           1 9051552 9051552  88.377 3.15e-11 ***\nexp:cult          1   36717   36717   0.359 0.553089    \nexp:silicio       1      49      49   0.000 0.982615    \ncult:silicio      1 1412562 1412562  13.792 0.000689 ***\nexp:cult:silicio  1  143643  143643   1.403 0.244065    \nResiduals        36 3687093  102419                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\naov1 <- aov(sqrt(audpc) ~cult*silicio, data = tw2)\nsummary(aov1) # modelo reduzido, foi significativo\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \ncult          1  294.0   294.0   13.51 0.000712 ***\nsilicio       1 2363.9  2363.9  108.65 7.81e-13 ***\ncult:silicio  1  526.5   526.5   24.20 1.62e-05 ***\nResiduals    39  848.6    21.8                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n1 observation deleted due to missingness\n```\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.146).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.638).\n```\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nm1 <- emmeans(aov1, ~ cult | silicio, type = \"response\")\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsilicio = Si-:\n cult      response    SE df lower.CL upper.CL\n Horizonte     1440 106.8 39     1233     1664\n Quartzo       1537 110.3 39     1322     1768\n\nsilicio = Si+:\n cult      response    SE df lower.CL upper.CL\n Horizonte      897  84.2 39      735     1075\n Quartzo        296  50.7 39      202      407\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the sqrt scale \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}