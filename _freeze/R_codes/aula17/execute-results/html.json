{
  "hash": "5f329316956dc1d1ba645a1e2d2afbc6",
  "result": {
    "markdown": "---\ntitle: \"**Não Linear**\"\nformat: html\neditor: visual\n\nexecute: \n  freeze: auto\n  cache: true\n  warning: false\n---\n\n\n## Para estimar EC50\n\nEC50: valor da dose que reduz 50% do crescimento micelial comparado com a dose zero\n\n\n::: {.cell hash='aula17_cache/html/unnamed-chunk-1_2736eb35c9ca2d7c75d3413f0b6ab533'}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(tidyverse)\n\ndat <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/15pCj0zljvd-TGECe67OMt6sa21xO8BqUgv4d-kU8qi8/edit#gid=0\")\n\n# Fazer sumarização\n\noptions(scipen=999)\ndat2 <- dat |> \n  select(-Isolate, -Population) |> \n# juntar em um valor só\n  group_by(Code, Year, Dose) |> # group_by trabalha junto com summarise\n    summarise(GC_mean = mean(GC))\n\nFGT152 <- dat2 |> \n  filter(Code == \"FGT152\")\n\nFGT152 |> \n  ggplot(aes(factor(Dose), GC_mean))+\n  geom_point()+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndat2 |> \n  ggplot(aes(factor(Dose), GC_mean))+\n  geom_point()+\n  geom_line()+\n  facet_wrap(~Code)\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n\n## EC50 com pacote DRM\n\n\n::: {.cell hash='aula17_cache/html/unnamed-chunk-2_ebdada5bc344c489cc34f7576c17b307'}\n\n```{.r .cell-code}\nlibrary(drc)\n\n# modelo LL.3 (modelo de três parâmetros e intercepta o eixo X)\ndrc1 <- drm(GC_mean ~ Dose, data = FGT152,\n    fct = LL.3())\nAIC(drc1) # qual o modelo melhor, quanto menor melhor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 33.60846\n```\n:::\n\n```{.r .cell-code}\nsummary(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Log-logistic (ED50 as parameter) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n               Estimate Std. Error t-value     p-value    \nb:(Intercept)  0.401905   0.053427  7.5225    0.001672 ** \nd:(Intercept) 47.540342   1.459890 32.5643 0.000005302 ***\ne:(Intercept)  7.220130   2.340119  3.0854    0.036739 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 1.993805 (4 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50   7.2201     2.3401\n```\n:::\n\n```{.r .cell-code}\n# modelo W1.3\ndrc2 <- drm(GC_mean ~ Dose, data = FGT152,\n    fct = W1.3())\nAIC(drc2) # qual o modelo melhor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 37.75192\n```\n:::\n\n```{.r .cell-code}\nsummary(drc2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nModel fitted: Weibull (type 1) with lower limit at 0 (3 parms)\n\nParameter estimates:\n\n              Estimate Std. Error t-value    p-value    \nb:(Intercept)  0.28354    0.04760  5.9567   0.003987 ** \nd:(Intercept) 48.38112    2.09996 23.0390 0.00002103 ***\ne:(Intercept) 30.12379   12.58003  2.3946   0.074796 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error:\n\n 2.680509 (4 degrees of freedom)\n```\n:::\n\n```{.r .cell-code}\nplot(drc2)\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc2, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error\ne:1:50   8.2704     3.6719\n```\n:::\n:::\n\n::: {.cell hash='aula17_cache/html/unnamed-chunk-3_55f2e1000ba79328bffd1b10eeb0ed86'}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n\ndf_ec50 <- estimate_EC50(GC_mean ~ Dose, \n                         data = dat2,\n                         isolate_col = \"Code\",\n                         interval = \"delta\",\n                         fct = drc::LL.3())\n\ndf_ec50 |> \n  ggplot(aes(Estimate))+\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndf_ec50 |>\n  ggplot(aes(Estimate, reorder(ID, Estimate)))+\n  geom_point()+\n  geom_errorbar(aes(xmin = Lower,\n                    xmax = Upper), width = 0.1)+\n  xlim(0,30)\n```\n\n::: {.cell-output-display}\n![](aula17_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}